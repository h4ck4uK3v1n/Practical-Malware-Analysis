# Lab 03-01

> Analyze the malware found in the file Lab03-01.exe using basic dynamic analysis tools.

- Questions:

  - 1. What are this malware’s imports and strings?
  - 2. What are the malware’s host-based indicators?
  - 3. Are there any useful network-based signatures for this malware? If so, what are they?

## 1) Imports and Strings?

- **Imports**: kernel32.dll

  - Only import is `ExitProcess`.

- **Strings**:
  - 1. Một số chuỗi như tên thư viện khác được sử dụng: `ws2_32`, `ntdll`, `user32`, `advapi32`.
  - 2. The `advapi32` and `registry key` strings indicate registry modifications.
  - 3. The `CurrentVersion\Run` registry key indicates that something new will start with Windows.
  - 4. The string `vmx32to64.exe` points to a possible malicious executable.
  - 5. A URL there is a possibly used for exfiltration, downloads, or calling home.

```ps1
ws2_32
CONNECT %s:%i HTTP/1.0
advapi32
ntdll
user32
advpack
SOFTWARE\Classes\http\shell\open\commandV
Software\Microsoft\Active Setup\Installed Components\
test
www.practicalmalwareanalysis.com
admin
VideoDriver
WinVMX32-
vmx32to64.exe
SOFTWARE\Microsoft\Windows\CurrentVersion\Run
SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell
Folders
AppData
```

## 2) Host Based Indicators?

- File: `C:\WINDOWS\System32\vmx32to64.exe` (d537acb8f56a1ce206bc35cf8ff959c0).
- Registry Key: `HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\VideoDriver`.
- Copied itself to system32 as `vmx32to64.exe`. Hashes match (`d537acb8f56a1ce206bc35cf8ff959c0`). Created a registry entry in `CurrentVersion\Run` for the created file, so it starts at boot.

![Lab03-01-01.png](../images/Lab03-01-01.png)

## 3) Network Based Indicators?

- URL: `www.practicalmalwareanalysis.com`.

- Regular DNS queries to `www.practicalmalwareanalysis.com`. Once responded, repeatedly tries to connect via `443/tcp` (https). inetsim says that it is receiving an unknown protocol. Custom authored?
